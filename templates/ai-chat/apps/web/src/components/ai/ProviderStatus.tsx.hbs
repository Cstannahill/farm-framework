import { useAIProviders } from '../../hooks/useAIProviders'
import { AlertCircle, CheckCircle2, XCircle } from 'lucide-react'
import { motion, AnimatePresence } from 'framer-motion'
import { cn } from '../../utils/cn'

export function ProviderStatus() {
  const { providers, isLoading } = useAIProviders()

  if (isLoading || Object.keys(providers).length === 0) return null

  const defaultProvider = Object.entries(providers).find(([_, info]) => info.is_default)
  
  if (!defaultProvider) return null

  const [name, info] = defaultProvider
  const isHealthy = info.status === 'healthy'

  return (
    <AnimatePresence>
      {!isHealthy && (
        <motion.div
          initial={{ opacity: 0, y: -20 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, y: -20 }}
          className={cn(
            "mx-4 mt-4 p-3 rounded-lg flex items-center gap-2",
            "bg-destructive/10 text-destructive"
          )}
        >
          <XCircle className="h-4 w-4" />
          <span className="text-sm">
            {name} provider is offline. {info.error || 'Please check your connection.'}
          </span>
        </motion.div>
      )}
    </AnimatePresence>
  )
}